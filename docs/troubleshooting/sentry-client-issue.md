# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "Sentry –∫–ª–∏–µ–Ω—Ç: –ù–µ–∞–∫—Ç–∏–≤–µ–Ω"

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è —Å—Ç–∞—Ç—É—Å "Sentry –∫–ª–∏–µ–Ω—Ç: –ù–µ–∞–∫—Ç–∏–≤–µ–Ω", —Ö–æ—Ç—è Sentry –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–ª.

## üîç –ü—Ä–∏—á–∏–Ω–∞

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤ Next.js App Router API routes Sentry –∫–ª–∏–µ–Ω—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ:

1. **API routes –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ server-side –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ**
2. **Sentry –∫–ª–∏–µ–Ω—Ç –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ API routes**
3. **`Sentry.getClient()` –≤–æ–∑–≤—Ä–∞—â–∞–ª `undefined`**

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Sentry –≤ API route `/api/sentry-diagnosis`:

```typescript
// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Sentry –¥–ª—è API routes
if (!Sentry.getClient()) {
  Sentry.init({
    dsn: process.env.SENTRY_DSN,
    environment: process.env.NODE_ENV,
    tracesSampleRate: process.env.NODE_ENV === "production" ? 0.1 : 1.0,
    debug:
      process.env.NODE_ENV === "development" ||
      process.env.SENTRY_DEBUG === "true",
  });
}
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

```json
{
  "sentry": {
    "isInitialized": true,
    "client": true,
    "dsn": "–Ω–∞—Å—Ç—Ä–æ–µ–Ω",
    "scope": true,
    "clientInfo": {
      "dsn": "–Ω–∞—Å—Ç—Ä–æ–µ–Ω",
      "environment": "development"
    }
  }
}
```

## üìã –°—Ç–∞—Ç—É—Å—ã –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

–¢–µ–ø–µ—Ä—å –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

- ‚úÖ **SENTRY_DSN**: –ù–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ **NEXT_PUBLIC_SENTRY_DSN**: –ù–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ **Sentry –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ **Sentry –∫–ª–∏–µ–Ω—Ç**: –ê–∫—Ç–∏–≤–µ–Ω
- ‚úÖ **–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ**: –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤:

- `Sentry.getClient()` –≤–æ–∑–≤—Ä–∞—â–∞–ª `undefined`
- `clientInfo` –±—ã–ª `null`
- DSN –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –∫–∞–∫ `[object Object]`

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** Sentry –≤ API route
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞** –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
3. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ DSN** –∫–∞–∫ "–Ω–∞—Å—Ç—Ä–æ–µ–Ω"/"–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–î–ª—è –¥—Ä—É–≥–∏—Ö API routes, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Sentry, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É** `if (!Sentry.getClient())`
2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Sentry** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å try-catch** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Sentry –≤ API route. –¢–µ–ø–µ—Ä—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Sentry —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.
